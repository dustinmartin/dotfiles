# Easier navigation: .., ..., ~ and -
alias ..="cd .."
alias ...="cd ../.."

# Fasd aliases
alias a='fasd -a'        # any
alias s='fasd -si'       # show / search / select
alias d='fasd -d'        # directory
alias f='fasd -f'        # file
alias sd='fasd -sid'     # interactive directory selection
alias sf='fasd -sif'     # interactive file selection
alias j='fasd_cd -d'     # cd, same functionality as j in autojump
alias z='fasd_cd -d'     # cd, same functionality as j in autojump
alias zz='fasd_cd -d -i' # cd with interactive selection
alias v='f -e vim' 		 # quick opening files with vim

# Tmux
# alias tmx='tmux -2'
alias tmux="TERM=screen-256color-bce tmux"

# Fix rake to work with zsh
alias rake="noglob rake"

# Miscellaneous Helpers
alias reload="source ~/.zshrc"

# Set vim as the editor
export EDITOR='vim'

# List all files colorized in long format, including dot files
alias la="ls -Gla"

# List only directories
alias lsd='ls -l | grep "^d"'

# List files with details
alias ll="ls -Gl"

# Show colors for ls
alias ls="ls -G"

# Show all hidden files
alias showf="defaults write com.apple.finder AppleShowAllFiles TRUE; killall Finder"

# Hide all hidden files
alias hidef="defaults write com.apple.finder AppleShowAllFiles FALSE; killall Finder"

# Git
alias g='git'
alias gs='git status -s'
alias gst='git status'
alias gpl='git pull'
alias gplff='git pull --ff-only'
alias gm='git merge'
alias gmff='git merge --no-ff'
alias gpu='git push'
alias gf='git fetch'
alias gco='git checkout'
alias gb='git branch'
alias grb='git rebase'
alias gd='git diff'
alias ga='git add'
alias grm='git rm'
alias gl='git log'

alias gcom='git checkout master'

# Commit staged changed and provide some stats on the commit
alias gc='git commit -v -m'

# Stage all updated/added/deleted files and commit
alias gca='git add -u && git add . && git commit -v -m'

# Create a new branch
alias gcob='git checkout -b'

# Stage all updated/added/deleted files
alias gaa='git add -u && git add . && git status'

# Updates a branch
gup() {
	echo "> Fetching updates from origin"
	echo
	git fetch origin 
	echo
	echo "> Rebasing origin/master"
	echo
	git rebase origin/master
}

# Interactive rebase
gir() {
	echo "Rebasing (interactive) origin/master"
	git rebase -i origin/master
}

# Merges branch back into master
gdone() {
	if [[ $(is_git_dirty) = true ]] then
	    echo "The repo is dirty. Please commit all changes first."
	else
		branch=$(current_branch)
		echo "Fetching changes 'develop' - git fetch origin develop"
		git fetch origin develop
		echo
		echo "Rebasing - git rebase origin/develop"
		git rebase origin/develop
		echo
		echo "Checking out 'develop' - git checkout develop"
		git checkout develop
		echo
		echo "Pulling 'develop' - git pull --ff-only"
		git pull --ff-only
		echo
		echo "Merging into 'develop' - git merge --no-ff $branch"
		git merge --no-ff $branch
		echo
		echo "Pushing changes from 'develop' to repo - git push origin develop"
		git push origin develop		
	fi
}

# Get the current branch
current_branch() {
	ref=$(git symbolic-ref HEAD 2> /dev/null) || return
	echo ${ref#refs/heads/}
}

# Returns if the git repo in the current directory is dirty
is_git_dirty() {
	if [[ $(git status 2> /dev/null | tail -n1) != "nothing to commit (working directory clean)" ]] then
		echo true
	else
		echo false
	fi
}
